<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>SpringCloud 篇 | 捞月亮の小北</title><meta name="author" content="捞月亮の小北"><meta name="copyright" content="捞月亮の小北"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="1、什么是Spring cloud 流应用程序启动器是基于 Spring Boot 的 Spring 集成应用程序，提供与外部系统的集成。Spring cloud Task，一个生命周期短暂的微服务框架，用于快速构建执行有限数据处理的应用程序。 2、什么是微服务微服务架构是一种架构模式或者说是一种架构风格，它提倡将单一应用程序划分为一组小的服务，每个服务运行在其独立的自己的进程中，服务之间相互协调">
<meta property="og:type" content="article">
<meta property="og:title" content="SpringCloud 篇">
<meta property="og:url" content="https://lunanorth.github.io/posts/28286.html">
<meta property="og:site_name" content="捞月亮の小北">
<meta property="og:description" content="1、什么是Spring cloud 流应用程序启动器是基于 Spring Boot 的 Spring 集成应用程序，提供与外部系统的集成。Spring cloud Task，一个生命周期短暂的微服务框架，用于快速构建执行有限数据处理的应用程序。 2、什么是微服务微服务架构是一种架构模式或者说是一种架构风格，它提倡将单一应用程序划分为一组小的服务，每个服务运行在其独立的自己的进程中，服务之间相互协调">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://testingcf.jsdelivr.net/gh/LunaNorth/img-cloud/images/wallhaven-7p7wev.png">
<meta property="article:published_time" content="2024-08-29T03:06:46.000Z">
<meta property="article:modified_time" content="2024-08-29T03:11:40.624Z">
<meta property="article:author" content="捞月亮の小北">
<meta property="article:tag" content="SpringCloud">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://testingcf.jsdelivr.net/gh/LunaNorth/img-cloud/images/wallhaven-7p7wev.png"><link rel="shortcut icon" href="/img/moon.png"><link rel="canonical" href="https://lunanorth.github.io/posts/28286.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: {"limitDay":500,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":300},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'SpringCloud 篇',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-08-29 11:11:40'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/css/custom.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="/css/navigation.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="/css/universe.css"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-double-row-display@1.00/cardlistpost.min.css"/>
<style>#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags:before {content:"\A";
  white-space: pre;}#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags > .article-meta__separator{display:none}</style>
<link rel="stylesheet" href="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.css" /><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiperstyle.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload="this.media='all'"><script src="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/carousel-touch.js"></script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">60</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">26</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">7</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw far fa-paper-plane"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page" href="/essay/"><i class="fa-fw fas fa-comments"></i><span> 碎碎念</span></a></div><div class="menus_item"><a class="site-page" href="/collect/"><i class="fa-fw fa fa-book"></i><span> 藏宝阁</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://testingcf.jsdelivr.net/gh/LunaNorth/img-cloud/images/wallhaven-7p7wev.png')"><nav id="nav"><span id="blog-info"><a href="/" title="捞月亮の小北"><img class="site-icon" src="/img/moon.png"/><span class="site-name">捞月亮の小北</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw far fa-paper-plane"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page" href="/essay/"><i class="fa-fw fas fa-comments"></i><span> 碎碎念</span></a></div><div class="menus_item"><a class="site-page" href="/collect/"><i class="fa-fw fa fa-book"></i><span> 藏宝阁</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">SpringCloud 篇</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-08-29T03:06:46.000Z" title="发表于 2024-08-29 11:06:46">2024-08-29</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-08-29T03:11:40.624Z" title="更新于 2024-08-29 11:11:40">2024-08-29</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E9%9D%A2%E8%AF%95%E6%80%BB%E7%BB%93/">面试总结</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">13k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>41分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="SpringCloud 篇"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="1、什么是"><a href="#1、什么是" class="headerlink" title="1、什么是"></a>1、什么是</h2><p>Spring cloud 流应用程序启动器是基于 Spring Boot 的 Spring 集成应用程序，提供与外部系统的集成。Spring cloud Task，一个生命周期短暂的微服务框架，用于快速构建执行有限数据处理的应用程序。</p>
<h2 id="2、什么是微服务"><a href="#2、什么是微服务" class="headerlink" title="2、什么是微服务"></a>2、什么是微服务</h2><p>微服务架构是一种架构模式或者说是一种架构风格，它提倡将单一应用程序划分为一组小的服务，每个服务运行在其独立的自己的进程中，服务之间相互协调、互相配合，为用户提供最终价值。服务之间采用轻量级的通信机制互相沟通（通常是基于 HTTP 的 RESTful API）,每个服务都围绕着具体的业务进行构建，并且能够被独立的构建在生产环境、类生产环境等。另外，应避免统一的、集中式的服务管理机制，对具体的一个服务而言，应根据业务上下文，选择合适的语言、工具对其进行构建，可以有一个非常轻量级的集中式管理来协调这些服务，可以使用不同的语言来编写服务，也可以使用不同的数据存储。</p>
<h2 id="3、SpringCloud-有什么优势"><a href="#3、SpringCloud-有什么优势" class="headerlink" title="3、SpringCloud 有什么优势"></a>3、SpringCloud 有什么优势</h2><p>使用 Spring Boot 开发分布式微服务时，我们面临以下问题</p>
<p>（1）与分布式系统相关的复杂性-这种开销包括网络问题，延迟开销，带宽问题，安全问题。</p>
<p>（2）服务发现-服务发现工具管理群集中的流程和服务如何查找和互相交谈。它涉及一个服务目录，在该目录中注册服务，然后能够查找并连接到该目录中的服务。</p>
<p>（3）冗余-分布式系统中的冗余问题。</p>
<p>（4）负载平衡 –负载平衡改善跨多个计算资源的工作负荷，诸如计算机，计算机集群，网络链路，中央处理单元，或磁盘驱动器的分布。</p>
<p>（5）性能-问题 由于各种运营开销导致的性能问题。</p>
<p>（6）部署复杂性-Devops 技能的要求。</p>
<h2 id="4、-什么是服务熔断？什么是服务降级？"><a href="#4、-什么是服务熔断？什么是服务降级？" class="headerlink" title="4、 什么是服务熔断？什么是服务降级？"></a>4、 什么是服务熔断？什么是服务降级？</h2><p><strong>熔断机制是应对雪崩效应的一种微服务链路保护机制</strong>。当某个微服务不可用或者响应时间太长时，会进行服务降级，进而熔断该节点微服务的调用，快速返回“错误”的响应信息。当检测到该节点微服务调用响应正常后恢复调用链路。在 SpringCloud 框架里熔断机制通过Hystrix 实现，Hystrix 会监控微服务间调用的状况，当失败的调用到一定阈值，缺省是 5 秒内调用 20 次，如果失败，就会启动熔断机制。服务降级，一般是从整体负荷考虑。就是当某个服务熔断之后，服务器将不再被调用，此时客户端可以自己准备一个本地的 fallback回调，返回一个缺省值。这样做，虽然水平下降，但好歹可用，比直接挂掉强。</p>
<p><strong>Hystrix 相关注解</strong> @EnableHystrix：开启熔断 @HystrixCommand(fallbackMethod&#x3D;”XXX”)：声明一个失败回滚处理函数 XXX，当被注解的方法执行超时（默认是 1000 毫秒），就会执行 fallback 函数，返回错误提示。</p>
<h2 id="5、Eureka-和-zookeeper-都可以提供服务注册与发现的功能，请说说两个的区别？"><a href="#5、Eureka-和-zookeeper-都可以提供服务注册与发现的功能，请说说两个的区别？" class="headerlink" title="5、Eureka 和 zookeeper 都可以提供服务注册与发现的功能，请说说两个的区别？"></a>5、Eureka 和 zookeeper 都可以提供服务注册与发现的功能，请说说两个的区别？</h2><p>Zookeeper 保证了CP（C：一致性，P：分区容错性），Eureka 保证了AP（A：高可用，P：分区容错性）</p>
<p>1.当向注册中心查询服务列表时，我们可以容忍注册中心返回的是几分钟以前的信息，但不能容忍直接 down 掉不可用。也就是说，服务注册功能对高可用性要求比较高，但 zk 会出现这样一种情况，当 master 节点因为网络故障与其他节点失去联系时，剩余节点会重新选 leader。问题在于，选取 leader 时间过长，30 ~ 120 s，且选取期间 zk 集群都不可用，这样就会导致选取期间注册服务瘫痪。在云部署的环境下，因网络问题使得zk集群失去master节点是较大概率会发生的事，虽然服务能够恢复，但是漫长的选取时间导致的注册长期不可用是不能容忍的。</p>
<p>2.Eureka 保证了可用性，Eureka 各个节点是平等的，几个节点挂掉不会影响正常节点的工作，剩余的节点仍然可以提供注册和查询服务。而 Eureka 的客户端向某个 Eureka 注册或发现时发生连接失败，则会自动切换到其他节点，只要有一台 Eureka 还在，就能保证注册服务可用，只是查到的信息可能不是最新的。除此之外，Eureka 还有自我保护机制，如果在 15 分钟内超过 85% 的节点没有正常的心跳，那么 Eureka 就认为客户端与注册中心发生了网络故障，此时会出现以下几种情况：</p>
<p>①、Eureka 不在从注册列表中移除因为长时间没有收到心跳而应该过期的服务。</p>
<p>②、Eureka 仍然能够接受新服务的注册和查询请求，但是不会被同步到其他节点上（即保证当前节点仍然可用）</p>
<p>③、当网络稳定时，当前实例新的注册信息会被同步到其他节点。</p>
<p>因此，Eureka 可以很好的应对因网络故障导致部分节点失去联系的情况，而不会像 Zookeeper 那样使整个微服务瘫痪</p>
<h2 id="6、SpringBoot-和-SpringCloud-的区别？"><a href="#6、SpringBoot-和-SpringCloud-的区别？" class="headerlink" title="6、SpringBoot 和 SpringCloud 的区别？"></a>6、SpringBoot 和 SpringCloud 的区别？</h2><p>SpringBoot 专注于快速方便的开发单个个体微服务。</p>
<p>SpringCloud 是关注全局的微服务协调整理治理框架，它将 SpringBoot 开发的一个个单体微服务整合并管理起来，为各个微服务之间提供，配置管理、服务发现、断路器、路由、微代理、事件总线、全局锁、决策竞选、分布式会话等等集成服务</p>
<p>SpringBoot 可以离开 SpringCloud 独立使用开发项目， 但是 SpringCloud 离不开 SpringBoot ，属于依赖的关系。SpringBoot 专注于快速、方便的开发单个微服务个体，SpringCloud 关注全局的服务治理框架。</p>
<h2 id="7、负载平衡的意义什么？"><a href="#7、负载平衡的意义什么？" class="headerlink" title="7、负载平衡的意义什么？"></a>7、负载平衡的意义什么？</h2><p>在计算中，负载平衡可以改善跨计算机，计算机集群，网络链接，中央处理单元或磁盘驱动器等多种计算资源的工作负载分布。负载平衡旨在优化资源使用，最大化吞吐量，最小化响应时间并避免任何单一资源的过载。使用多个组件进行负载平衡而不是单个组件可能会通过冗余来提高可靠性和可用性。负载平衡通常涉及专用软件或硬件，例如多层交换机或域名系统服务器进程。</p>
<h2 id="8、什么是-Hystrix-？它如何实现容错？"><a href="#8、什么是-Hystrix-？它如何实现容错？" class="headerlink" title="8、什么是 Hystrix ？它如何实现容错？"></a>8、什么是 Hystrix ？它如何实现容错？</h2><p>Hystrix 是一个延迟和容错库，旨在隔离远程系统，服务和第三方库的访问点，当出现不可避免的故障时，停止级联故障并在复杂的分布式系统中实现弹性。</p>
<p>通常对于使用微服务架构开发的系统，涉及到许多微服务。这些微服务彼此协作。思考以下微服务</p>
<p><img src="https://testingcf.jsdelivr.net/gh/LunaNorth/img-cloud/images/network-asset-7-1-20240823074502-yvz8mov.png">​</p>
<p>假设如果上图中的微服务 9 失败了，那么使用传统方法我们将传播一个异常。但这仍然会导致整个系统崩溃。</p>
<p>随着微服务数量的增加，这个问题变得更加复杂。微服务的数量可以高达 1000。这是 hystrix 出现的地方，我们将使用 Hystrix 在这种情况下的 Fallback 方法功能。我们有两个服务 employee-consumer 使用由 employee-consumer 公开的服务。</p>
<p>简化图如下所示</p>
<p><img src="https://testingcf.jsdelivr.net/gh/LunaNorth/img-cloud/images/network-asset-7-2-20240823074502-gshbqnk.png">​</p>
<p>现在假设由于某种原因，employee-producer 公开的服务会抛出异常。我们在这种情况下使用 Hystrix 定义了一个回退方法。这种后备方法应该具有与公开服务相同的返回类型。如果暴露服务中出现异常，则回退方法将返回一些值。</p>
<h2 id="9、什么是-Hystrix-断路器？我们需要它吗？"><a href="#9、什么是-Hystrix-断路器？我们需要它吗？" class="headerlink" title="9、什么是 Hystrix 断路器？我们需要它吗？"></a>9、什么是 Hystrix 断路器？我们需要它吗？</h2><p>由于某些原因，employee-consumer 公开服务会引发异常。在这种情况下使用 Hystrix 我们定义了一个回退方法。如果在公开服务中发生异常，则回退方法返回一些默认值</p>
<p><img src="https://testingcf.jsdelivr.net/gh/LunaNorth/img-cloud/images/network-asset-7-3-20240823074503-lmdlkuu.png">​</p>
<p>如果 firstPage method() 中的异常继续发生，则 Hystrix 电路将中断，并且员工使用者将一起跳过 firtsPage 方法，并直接调用回退方法。 断路器的目的是给第一页方法或第一页方法可能调用的其他方法留出时间，并导致异常恢复。可能发生的情况是，在负载较小的情况下，导致异常的问题有更好的恢复机会 。</p>
<p><img src="https://testingcf.jsdelivr.net/gh/LunaNorth/img-cloud/images/network-asset-7-4-20240823074503-b8b1gec.png">​</p>
<h2 id="10、说说-RPC-的实现原理"><a href="#10、说说-RPC-的实现原理" class="headerlink" title="10、说说 RPC 的实现原理"></a>10、说说 RPC 的实现原理</h2><p>首先需要有处理网络连接通讯的模块，负责连接建立、管理和消息的传输。其次需要有编解码的模块，因为网络通讯都是传输的字节码，需要将我们使用的对象序列化和反序列化。剩下的就是客户端和服务器端的部分，服务器端暴露要开放的服务接口，客户调用服务接口的一个代理实现，这个代理实现负责收集数据、编码并传输给服务器然后等待结果返回。</p>
<h2 id="11、Eureka-自我保护机制是什么"><a href="#11、Eureka-自我保护机制是什么" class="headerlink" title="11、Eureka 自我保护机制是什么?"></a>11、Eureka 自我保护机制是什么?</h2><p>当 Eureka Server 节点在短时间内丢失了过多实例的连接时（比如网络故障或频繁启动关闭客户端）节点会进入自我保护模式，保护注册信息，不再删除注册数据，故障恢复时，自动退出自我保护模式。</p>
<h2 id="12、什么是-Ribbon-？"><a href="#12、什么是-Ribbon-？" class="headerlink" title="12、什么是 Ribbon ？"></a>12、什么是 Ribbon ？</h2><p>ribbon 是一个负载均衡客户端，可以很好的控制 http 和 tcp 的一些行为。feign 默认集成了 ribbon。</p>
<h2 id="13、什么是-feigin-？它的优点是什么？"><a href="#13、什么是-feigin-？它的优点是什么？" class="headerlink" title="13、什么是 feigin ？它的优点是什么？"></a>13、什么是 feigin ？它的优点是什么？</h2><p>1.feign 采用的是基于接口的注解</p>
<p>2.feign 整合了 ribbon，具有负载均衡的能力</p>
<p>3.整合了 Hystrix，具有熔断的能力</p>
<p>使用: 1.添加 pom 依赖。 2.启动类添加 @EnableFeignClients 3.定义一个接口 @FeignClient(name&#x3D;“xxx”) 指定调用哪个服务</p>
<h2 id="14、Ribbon-和-Feign-的区别？"><a href="#14、Ribbon-和-Feign-的区别？" class="headerlink" title="14、Ribbon 和 Feign 的区别？"></a>14、Ribbon 和 Feign 的区别？</h2><p>1.Ribbon 都是调用其他服务的，但方式不同。</p>
<p>2.启动类注解不同，Ribbon 是 @RibbonClient；feign 的是 @EnableFeignClients</p>
<p>3.服务指定的位置不同，Ribbon 是在 @RibbonClient 注解上声明，Feign则是在定义抽象方法的接口中使用 @FeignClient 声明。</p>
<p>4.调用方式不同，Ribbon 需要自己构建 http 请求，模拟 http 请求</p>
<h2 id="15、如何设计一个注册中心？"><a href="#15、如何设计一个注册中心？" class="headerlink" title="15、如何设计一个注册中心？"></a>15、如何设计一个注册中心？</h2><p><img src="https://testingcf.jsdelivr.net/gh/LunaNorth/img-cloud/images/network-asset-7-5-20240823074504-fh1aur5.png">​</p>
<ul>
<li>服务注册</li>
<li>注册表结构设计服务发现</li>
<li>服务订阅</li>
<li>服务推送</li>
<li>健康检查</li>
<li>集群同步：设计到数据同步，数据同步我们有哪些协议 raft 、distro、ZAB</li>
</ul>
<h2 id="16、Nacos1-x-作为注册中心的原理？"><a href="#16、Nacos1-x-作为注册中心的原理？" class="headerlink" title="16、Nacos1.x 作为注册中心的原理？"></a>16、Nacos1.x 作为注册中心的原理？</h2><p>1、使用 HTTP 发送注册</p>
<p>2、查询服务提供方列表</p>
<p>3、定时拉取（每 10 秒）</p>
<p>4、检测到服务提供者异常，基于 UDP 协议推送更新</p>
<p>5、定时心跳（5 秒），检测服务状态</p>
<p>6、定时心跳任务检查</p>
<p>7、集群数据同步任务使用 Distro</p>
<p><img src="https://testingcf.jsdelivr.net/gh/LunaNorth/img-cloud/images/network-asset-7-6-20240823074504-jygoz5n.png">​</p>
<h2 id="17、Nacos-服务领域模型有哪些？"><a href="#17、Nacos-服务领域模型有哪些？" class="headerlink" title="17、Nacos 服务领域模型有哪些？"></a>17、Nacos 服务领域模型有哪些？</h2><table>
<thead>
<tr>
<th><strong>模型名称</strong></th>
<th><strong>解释</strong></th>
</tr>
</thead>
<tbody><tr>
<td>NameSpace</td>
<td>实现环境隔离，默认值 public</td>
</tr>
<tr>
<td>Group</td>
<td>不同的 service 可以组成一个 Group，默认值 Default-Group</td>
</tr>
<tr>
<td>Service</td>
<td>服务名称</td>
</tr>
<tr>
<td>Cluster</td>
<td>对指定的微服务虚拟划分，默认值Default</td>
</tr>
<tr>
<td>Instance</td>
<td>某个服务的具体实例</td>
</tr>
</tbody></table>
<p>Nacos 服务注册中心于发现的领域模型的最佳实践。</p>
<p><img src="https://testingcf.jsdelivr.net/gh/LunaNorth/img-cloud/images/network-asset-7-7-20240823074505-dk64nha.png">​</p>
<h2 id="18、Nacos中的Distro协议"><a href="#18、Nacos中的Distro协议" class="headerlink" title="18、Nacos中的Distro协议"></a>18、Nacos中的Distro协议</h2><ul>
<li>Nacos 每个节点自己负责部分的写请求。</li>
<li>每个节点会把自己负责的新增数据同步给其他节点。</li>
<li>每个节点定时发送自己负责数据的校验值到其他节点来保持数据一致性。</li>
<li>每个节点独立处理读请求，及时从本地发出响应。</li>
<li>新加入的 Distro 节点会进行全量数据拉取。（具体操作是轮询所有的 Distro节点，通过向其他的机器发送请求拉取全量数据。）</li>
<li><img src="https://testingcf.jsdelivr.net/gh/LunaNorth/img-cloud/images/network-asset-7-8-20240823074505-h47vrk3.png">​</li>
</ul>
<h2 id="19、配置中心的技术选型"><a href="#19、配置中心的技术选型" class="headerlink" title="19、配置中心的技术选型"></a>19、配置中心的技术选型</h2><table>
<thead>
<tr>
<th>功能点</th>
<th><strong>Spring Cloud Config</strong></th>
<th><strong>Apollo</strong></th>
<th><strong>Nacos</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>版本管理</strong></td>
<td>支持（Git）</td>
<td>支持</td>
<td>支持</td>
</tr>
<tr>
<td><strong>配置实时推送</strong></td>
<td>支持（Spring Cloud Bus）</td>
<td>支持（HTTP 长轮询 1 s 内）</td>
<td>支持（HTTP 长轮询 1 s 内 或者 grpc）</td>
</tr>
<tr>
<td><strong>配置回滚</strong></td>
<td>支持（Git）</td>
<td>支持</td>
<td>支持</td>
</tr>
<tr>
<td><strong>灰度发布</strong></td>
<td>支持（调用机器接口）</td>
<td>支持</td>
<td><strong>不支持</strong></td>
</tr>
<tr>
<td><strong>权限管理</strong></td>
<td>支持（依赖 Git）</td>
<td>支持</td>
<td>支持</td>
</tr>
<tr>
<td><strong>配置生效时间</strong></td>
<td><strong>重启</strong></td>
<td>实时</td>
<td>实时</td>
</tr>
<tr>
<td>审计</td>
<td>支持（依赖 Git）</td>
<td>支持</td>
<td>不支持</td>
</tr>
<tr>
<td><strong>多集群</strong></td>
<td>支持</td>
<td>支持</td>
<td>支持</td>
</tr>
<tr>
<td>多环境</td>
<td>支持</td>
<td>支持</td>
<td>支持</td>
</tr>
<tr>
<td><strong>client 本地缓存</strong></td>
<td><strong>不支持</strong></td>
<td>支持</td>
<td>支持</td>
</tr>
<tr>
<td>监听查询</td>
<td>支持</td>
<td>支持</td>
<td>支持</td>
</tr>
<tr>
<td>运维成本</td>
<td>高</td>
<td>中等</td>
<td>较低</td>
</tr>
<tr>
<td><strong>多语言</strong></td>
<td>仅 Java</td>
<td>主流语言，提供了 Open API</td>
<td>主流语言，提供了 Open API</td>
</tr>
<tr>
<td><strong>配置项维护</strong></td>
<td>基于 Git</td>
<td>统一界面</td>
<td>统一界面</td>
</tr>
</tbody></table>
<h2 id="20、Nacos1-x-配置中心长轮询机制？"><a href="#20、Nacos1-x-配置中心长轮询机制？" class="headerlink" title="20、Nacos1.x 配置中心长轮询机制？"></a>20、Nacos1.x 配置中心长轮询机制？</h2><p>客户端会轮询向服务端发出一个长连接请求，这个长连接最多 30 s 就会超时，服务端收到客户端的请求会先判断当前是否有配置更新，有则立即返回，如果没有服务端会将这个请求拿住“hold” 29.5 s 加入队列，最后 0.5 s 再检测配置文件无论有没有更新都进行正常返回，但等待的 29.5 s 期间有配置更新可以提前结束并返回。</p>
<h2 id="21、Nacos-配置中心配置优先级？"><a href="#21、Nacos-配置中心配置优先级？" class="headerlink" title="21、Nacos 配置中心配置优先级？"></a>21、Nacos 配置中心配置优先级？</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#作用：顺序</span><br><span class="line">#$&#123;application.name&#125;-$&#123;profile&#125;.$&#123;file- extension&#125; nacos-config-prod.yaml</span><br><span class="line">#$&#123;application.name&#125;.$&#123;file-extension&#125; nacos-config.yaml</span><br><span class="line">#$&#123;application.name&#125; nacos-config</span><br><span class="line">#extensionConfigs 扩展配置文件</span><br><span class="line">#sharedConfigs 多个微服务公共配置 redis</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">spring.application.name=nacos-config</span><br><span class="line">server.port=8081</span><br><span class="line">#nacos地址</span><br><span class="line">spring.cloud.nacos.config.server-addr=localhost:8848</span><br><span class="line">#1、只有上面的配置的时候他默认加载文件为：$&#123;application.name&#125; nacos-config</span><br><span class="line">#2、指定文件后缀名称</span><br><span class="line">#加载文件为：$&#123;application.name&#125;.$&#123;file-extension&#125;</span><br><span class="line">#nacos-config.yaml</span><br><span class="line">#spring.cloud.nacos.config.file-extension=yaml</span><br><span class="line">##3、profile： 指定环境 文件名：$&#123;application.name&#125;-$&#123;profile&#125;.$&#123;file-extension&#125;</span><br><span class="line">##nacos-config-prod.yaml</span><br><span class="line">#spring.profiles.active=prod</span><br><span class="line">#4、nacos自己提供的环境隔离 ，这里是开发环境下的</span><br><span class="line">#spring.cloud.nacos.config.namespace=ff02931a-6fdb-4681-ac37-2f6d9a0596f8</span><br><span class="line">#5、 自定义 group 配置，这里也可以设置为数据库配置组，中间件配置组，但是一般不用，</span><br><span class="line"># 配置中心淡化了组的概念，使用默认值DEFAULT_GROUP</span><br><span class="line">#spring.cloud.nacos.config.group=DEFAULT_GROUP</span><br><span class="line">#</span><br><span class="line">#6、自定义Data Id的配置 共享配置（sharedConfigs）</span><br><span class="line">#spring.cloud.nacos.config.shared-configs[0].data-id= common.yaml</span><br><span class="line">##可以不配置，使用默认</span><br><span class="line">#spring.cloud.nacos.config.shared-configs[0].group=DEFAULT_GROUP</span><br><span class="line">## 这里需要设置为true，动态可以刷新，默认为false</span><br><span class="line">#spring.cloud.nacos.config.shared-configs[0].refresh=true</span><br><span class="line"># 7、扩展配置(extensionConfigs)</span><br><span class="line"># 支持一个应用有多个DataId配置，mybatis.yaml datasource.yaml</span><br><span class="line">#spring.cloud.nacos.config.extension-configs[0].data-id=datasource.yaml</span><br><span class="line">#spring.cloud.nacos.config.extension-configs[0].group=DEFAULT_GROUP</span><br><span class="line">#spring.cloud.nacos.config.extension-configs[0].refresh=true</span><br><span class="line"></span><br><span class="line">#作用：顺序</span><br><span class="line">#$&#123;application.name&#125;-$&#123;profile&#125;.$&#123;file- extension&#125; msb-edu-prod.yaml</span><br><span class="line">#$&#123;application.name&#125;.$&#123;file-extension&#125; nacos-config.yaml</span><br><span class="line">#$&#123;application.name&#125; nacos-config</span><br><span class="line">#extensionConfigs 扩展配置文件</span><br><span class="line">#sharedConfigs 多个微服务公共配置 redis</span><br></pre></td></tr></table></figure>

<h2 id="22、Nacos-2-x-客户端探活机制？"><a href="#22、Nacos-2-x-客户端探活机制？" class="headerlink" title="22、Nacos 2.x 客户端探活机制？"></a>22、Nacos 2.x 客户端探活机制？</h2><p>Nacos 2.x 引入了客户端探活机制，该机制主要用于检测服务实例的健康状态。具体来说，Nacos 2.x 客户端探活机制包括以下几个步骤：</p>
<ol>
<li>注册服务实例：服务提供者在启动时将自己的实例信息注册到 Nacos Server 中，包括 IP 地址、端口号和健康状态等。</li>
<li>心跳检测：Nacos Server 会周期性地向服务实例发送心跳请求，以检测实例是否存活。默认情况下，心跳检测间隔为 5 秒。</li>
<li>健康检测：服务实例在接收到 Nacos Server 的心跳请求后，会返回一个健康状态给 Nacos Server。如果服务实例长时间未返回健康状态或返回的状态为不健康，Nacos Server 会认为该实例不可用。</li>
<li>健康状态更新：服务实例的健康状态可能会因为各种原因发生变化，例如网络故障或服务异常。当服务实例的健康状态发生变化时，Nacos Server 会及时更新实例的健康状态。</li>
</ol>
<p>通过客户端探活机制，Nacos 可以动态地监测和管理服务实例的健康状态，以确保服务的可用性和稳定性。</p>
<h2 id="23、Ribbon-底层怎样实现不同服务的不同配置"><a href="#23、Ribbon-底层怎样实现不同服务的不同配置" class="headerlink" title="23、Ribbon 底层怎样实现不同服务的不同配置"></a>23、Ribbon 底层怎样实现不同服务的不同配置</h2><p>Ribbon 是一个负载均衡客户端，它的底层实现主要依赖于以下几个组件：</p>
<ol>
<li>服务发现：Ribbon 通过与服务注册中心（如 Eureka、Consul 或 Nacos）进行集成，获取可用的服务实例列表。通过服务发现，Ribbon 可以动态地获取不同服务的实例信息。</li>
<li>负载均衡策略：Ribbon 支持多种负载均衡策略，例如轮询、随机、加权随机、加权轮询等。根据不同的负载均衡策略，Ribbon 可以在不同的服务实例之间进行请求的分发。</li>
<li>配置管理：Ribbon 可以通过配置文件或配置中心（如 Spring Cloud Config 或 Nacos）获取服务的相关配置信息。这些配置信息可以包括连接超时时间、重试次数、连接池大小等。通过配置管理，Ribbon 可以根据不同的服务设置不同的配置。</li>
</ol>
<p>通过以上组件的协作，Ribbon 可以根据服务的不同配置来进行请求的负载均衡。例如，可以针对不同的服务设置不同的负载均衡策略或超时时间，以满足不同服务的需求。</p>
<h2 id="24、为什么-Feign-第一次调用耗时很长？"><a href="#24、为什么-Feign-第一次调用耗时很长？" class="headerlink" title="24、为什么 Feign 第一次调用耗时很长？"></a>24、为什么 Feign 第一次调用耗时很长？</h2><p>在使用 Feign 进行第一次调用时，可能会出现较长的耗时。这是由于以下原因：</p>
<ol>
<li>服务发现和负载均衡：Feign 在第一次调用时需要进行服务发现和负载均衡操作，以确定要调用的服务实例。这涉及到与服务注册中心通信、获取可用实例列表并选择一个实例等步骤，这些操作可能会花费一些时间。</li>
<li>远程调用初始化：在进行第一次远程调用时，Feign 需要初始化相关的 HTTP 连接和连接池等资源。这包括建立 TCP 连接、进行 TLS 握手（如果使用 HTTPS）以及创建 HTTP 请求等。这些初始化过程可能会导致一定的延迟。</li>
<li>服务实例的冷启动：如果服务实例处于空闲状态，可能会因为冷启动而导致第一次调用的耗时较长。冷启动时，服务实例需要进行初始化和加载相关资源，这可能会花费更多的时间。</li>
</ol>
<p><strong>为了减少 Feign 第一次调用的耗时，可以采取以下措施：</strong></p>
<ol>
<li>启用连接池：可以通过配置 Feign 使用连接池来复用 TCP 连接，减少连接的建立和释放开销，提高性能。</li>
<li>预热服务实例：可以通过定时任务或定时健康检查等方式，定期发送心跳请求或调用服务实例，使其保持活跃状态，避免冷启动带来的延迟。</li>
<li>调整超时时间：根据实际情况，可以适当调整 Feign 的超时时间设置，以确保在网络状况较差或服务响应较慢时，不会因超时导致请求失败。</li>
</ol>
<p>需要注意的是，Feign 的第一次调用耗时问题可能是正常现象，因为在微服务架构中，服务之间的通信和调用是不可避免的，而这些初始化和准备过程都需要一定的时间。</p>
<h2 id="25、Ribbon-的属性配置和类配置优先级"><a href="#25、Ribbon-的属性配置和类配置优先级" class="headerlink" title="25、Ribbon 的属性配置和类配置优先级"></a>25、Ribbon 的属性配置和类配置优先级</h2><p>在 Ribbon 中，属性配置和类配置有不同的优先级。具体来说，优先级从高到低如下：</p>
<ol>
<li>属性配置优先级高于类配置：如果在属性配置和类配置中同时设置了相同的属性，属性配置会覆盖类配置。属性配置通常是通过配置文件（如 <code>application.properties</code>​ 或 <code>application.yml</code>​）中的属性来进行设置。</li>
<li>类配置：类配置是通过编程方式进行设置，通常是通过创建 <code>RibbonClientConfiguration</code>​ 的子类并覆盖其中的方法来进行自定义配置。类配置中可以设置一些默认的属性值，这些属性值将被应用于所有的 Ribbon 客户端。</li>
<li>全局默认配置：Ribbon 还提供了一些全局默认配置，对所有的 Ribbon 客户端都生效。可以通过在配置文件中设置以”ribbon.”开头的属性来进行全局默认配置。</li>
</ol>
<p>总的来说，属性配置具有最高的优先级，会覆盖类配置和全局默认配置。类配置的优先级次之，而全局默认配置的优先级最低。通过这种优先级的设置，可以在不同的层级上对 Ribbon 进行灵活的配置和定制。</p>
<h2 id="26、Feign-的性能优化？"><a href="#26、Feign-的性能优化？" class="headerlink" title="26、Feign 的性能优化？"></a>26、Feign 的性能优化？</h2><p>要优化 Feign 的性能，可以考虑以下几个方面：</p>
<ol>
<li>启用连接池：通过配置 Feign 使用连接池来复用 TCP 连接，减少连接的建立和释放开销，提高性能。可以通过配置 <code>httpclient</code>​的相关属性，如 <code>maxTotalConnections</code>​ 和 <code>maxConnectionsPerRoute</code>​ 来控制连接池的大小。</li>
<li>调整超时时间：根据实际情况，可以适当调整Feign的超时时间设置，以确保在网络状况较差或服务响应较慢时，不会因超时导致请求失败。可以通过配置 <code>connectTimeout</code>​ 和 <code>readTimeout</code>​ 来设置连接超时和读取超时时间。</li>
<li>批量请求：如果有多个独立的请求需要发送给同一个服务，可以考虑使用 Feign 的批量请求功能，将多个请求合并为一个批量请求发送，减少网络开销和连接建立的次数，提高性能。</li>
<li>启用 GZIP 压缩：可以通过配置 Feign 启用 GZIP 压缩来减少网络传输的数据量，提高性能。可以通过设置 <code>Content-Encoding</code>​ 为<code>gzip</code>​来启用 GZIP 压缩。</li>
<li>启用 HTTP &#x2F; 2：如果服务端支持 HTTP &#x2F; 2 协议，可以通过配置 Feign 使用 HTTP &#x2F; 2 来提高性能。可以通过配置 <code>httpclient</code>​ 的相关属性，如 <code>sslContextBuilder</code>​ 和 <code>alpnProtocols</code>​ 来启用 HTTP &#x2F; 2。</li>
<li>缓存：对于一些不经常变动的数据，可以考虑在客户端使用缓存，减少对服务端的请求，提高性能。可以使用 Spring Cache 等缓存框架来实现。</li>
<li>并发请求：如果有多个独立的请求需要发送给不同的服务，可以考虑使用并发请求的方式，同时发送多个请求，减少请求的等待时间，提高性能。可以使用异步方式发送请求，或使用并发工具类如 CompletableFuture 来实现。</li>
</ol>
<p>注意，优化 Feign 的性能需要根据具体场景和需求进行调整和测试。不同的应用场景可能需要不同的优化策略，因此需要根据实际情况选择合适的优化方法。</p>
<p>Feign 底层默认是 JDK 自带的 HttpURLConnection，它是单线程发送 HTTP 请求的，不能配置线程池，我们使用 OKHttp 或者 HttpClient 来发送 HTTP 请求，并且它们两个都支持线程池。</p>
<p>常见HTTP客户端</p>
<p><strong>HttpClient</strong></p>
<p>HttpClient 是 Apache Jakarta Common 下的子项目，用来提供高效的、最新的、功能丰富的支持 HTTP 协 议的客户端编程工具包，并且它支持 HTTP 协议最新版本和建议。HttpClient 相比传统  JDK 自带的 URLConnection，提升了易用性和灵活性，使客户端发送 HTTP 请求变得容易，提高了开发的效率。</p>
<p><strong>Okhttp</strong></p>
<p>一个处理网络请求的开源项目，是安卓端最火的轻量级框架，由 Square 公司贡献，用于替代 HttpUrlConnection 和 Apache HttpClient。OKHttp 拥有简洁的 API、高效的性能，并支持多种协议 （HTTP&#x2F;2 和 SPDY）。</p>
<p><strong>HttpURLConnection</strong></p>
<p>HttpURLConnection 是 Java 的标准类，它继承自 URLConnection，可用于向指定网站发送  GET 请求、 POST 请求。HttpURLConnection 使用比较复杂，不像 HttpClient 那样容易使用。</p>
<p><strong>RestTemplate</strong></p>
<p>RestTemplate 是 Spring 提供的用于访问 Rest 服务的客户端，RestTemplate 提供了多种便捷访问远程 HTTP 服务的方法，能够大大提高客户端的编写效率。</p>
<h2 id="27、Feign-怎样实现认证的传递？"><a href="#27、Feign-怎样实现认证的传递？" class="headerlink" title="27、Feign 怎样实现认证的传递？"></a>27、Feign 怎样实现认证的传递？</h2><p>在 Feign 中实现认证的传递，可以通过以下几种方式：</p>
<ol>
<li>使用请求头传递认证信息：可以在 Feign 的请求方法上添加 <code>@RequestHeader</code>​ 注解，将认证信息作为请求头的一部分进行传递。例如：</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@FeignClient(name = &quot;example-service&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ExampleServiceClient</span> &#123;</span><br><span class="line">    <span class="meta">@GetMapping(&quot;/api/example&quot;)</span></span><br><span class="line">    String <span class="title function_">getExampleData</span><span class="params">(<span class="meta">@RequestHeader(&quot;Authorization&quot;)</span> String token)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在调用 <code>getExampleData</code>​ 方法时，可以将认证信息作为参数传入，Feign 会将其放入请求头中。</p>
<ol start="2">
<li>使用请求参数传递认证信息：可以在 Feign 的请求方法上添加<code>@RequestParam</code>​注解，将认证信息作为请求参数进行传递。例如：</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@FeignClient(name = &quot;example-service&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ExampleServiceClient</span> &#123;</span><br><span class="line">    <span class="meta">@GetMapping(&quot;/api/example&quot;)</span></span><br><span class="line">    String <span class="title function_">getExampleData</span><span class="params">(<span class="meta">@RequestParam(&quot;token&quot;)</span> String token)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在调用 <code>getExampleData</code>​ 方法时，可以将认证信息作为参数传入，Feign 会将其作为请求参数进行传递。</p>
<ol start="3">
<li>使用请求体传递认证信息：可以在Feign的请求方法上添加 <code>@RequestBody</code>​ 注解，将认证信息作为请求体的一部分进行传递。例如：</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@FeignClient(name = &quot;example-service&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ExampleServiceClient</span> &#123;</span><br><span class="line">    <span class="meta">@PostMapping(&quot;/api/example&quot;)</span></span><br><span class="line">    String <span class="title function_">postExampleData</span><span class="params">(<span class="meta">@RequestBody</span> AuthRequest request)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AuthRequest</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String token;</span><br><span class="line">    <span class="comment">// getters and setters</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在调用<code>postExampleData</code>​方法时，可以创建一个包含认证信息的请求体对象，并作为参数传入。</p>
<p>需要注意的是，以上方法仅适用于将认证信息传递给后端服务。在后端服务中，需要进行相应的认证验证和处理。另外，认证信息的传递方式应根据具体的认证机制和安全要求进行选择和配置。</p>
<h2 id="28、谈谈-Sentienl-中使用的限流算法"><a href="#28、谈谈-Sentienl-中使用的限流算法" class="headerlink" title="28、谈谈 Sentienl 中使用的限流算法"></a>28、谈谈 Sentienl 中使用的限流算法</h2><p>Sentinel 是一个开源的分布式系统的流量防控组件，它提供了实时的流量控制、熔断降级、系统负载保护等功能。在 Sentienl 中使用的限流算法主要有以下几种：</p>
<ol>
<li>固定窗口计数器（Fixed Window Counter）：该算法是最简单的限流算法之一，它将请求按照时间窗口进行计数，当窗口内的请求数超过阈值时进行限流。例如，可以设置每秒钟最多处理 100 个请求，超过该阈值的请求将被限流。</li>
<li>滑动窗口计数器（Sliding Window Counter）：该算法是固定窗口计数器的改进版，它不仅考虑了窗口内的请求数，还考虑了窗口内的时间分布。例如，可以将时间窗口划分为若干个小窗口，每个小窗口内都有一个请求数的阈值，当整个时间窗口内的请求数超过阈值时进行限流。</li>
<li>令牌桶算法（Token Bucket）：该算法是一种基于令牌的限流算法，它维护一个固定容量的令牌桶，每个令牌代表一个请求的权限。当请求到达时，需要从令牌桶中获取一个令牌，如果令牌桶为空，则表示无法获取令牌，请求将被限流。令牌桶算法可以平滑处理请求的流量。</li>
<li>漏桶算法（Leaky Bucket）：该算法是一种基于漏桶的限流算法，它将请求看作水滴，漏桶作为一个固定容量的桶，请求以恒定的速率流入桶中，如果桶满了，则表示请求无法处理，被限流。漏桶算法可以平滑处理突发的请求流量。</li>
</ol>
<p>以上是 Sentienl 中使用的常见限流算法，根据具体的应用场景和需求，可以选择合适的算法进行限流。</p>
<h2 id="29、谈谈-Sentienl-服务熔断过程"><a href="#29、谈谈-Sentienl-服务熔断过程" class="headerlink" title="29、谈谈 Sentienl 服务熔断过程"></a>29、谈谈 Sentienl 服务熔断过程</h2><p>Sentinel 是一个流量控制组件，除了限流功能外，还提供了熔断降级的功能。在 Sentinel 中，服务熔断是一种保护机制，用于防止故障服务对整个系统的影响。下面是 Sentinel 服务熔断的一般过程：</p>
<ol>
<li>监控服务调用：Sentinel 会监控服务的调用情况，包括请求的成功率、响应时间等指标。通过实时收集和统计这些指标，Sentinel 可以判断服务是否正常运行。</li>
<li>熔断条件判断：当服务的某些指标超过预设的阈值时，Sentinel 就会触发熔断条件判断。例如，可以设置当服务的请求错误率超过 50% 时触发熔断。</li>
<li>进入熔断状态：一旦触发熔断条件，Sentinel 会将服务切换到熔断状态。在熔断状态下，Sentinel 会拒绝对该服务的请求，并返回预设的错误信息或者空响应。这样可以避免故障服务对整个系统的影响。</li>
<li>熔断恢复：在熔断状态下，Sentinel 会定时尝试恢复服务。它会允许一部分请求通过，以测试服务的可用性。如果这些请求成功率达到一定的阈值，Sentinel 就会认为服务已经恢复正常，将服务切换回正常状态。</li>
<li>熔断保护：为了防止熔断状态频繁切换，Sentinel 还提供了熔断保护机制。当服务切换回正常状态后，Sentinel 会暂时禁止对该服务的请求，以避免服务被过多的请求压垮。</li>
</ol>
<p>通过以上的熔断过程，Sentinel 可以有效地保护系统免受故障服务的影响，提高系统的可用性和稳定性。</p>
<h2 id="30、在-Gateway-中怎样实现服务平滑迁移？"><a href="#30、在-Gateway-中怎样实现服务平滑迁移？" class="headerlink" title="30、在 Gateway 中怎样实现服务平滑迁移？"></a>30、在 Gateway 中怎样实现服务平滑迁移？</h2><p>在 Gateway 中实现服务平滑迁移可以采用以下步骤：</p>
<ol>
<li>配置多个后端服务：在 Gateway 的配置中，同时配置新旧两个版本的后端服务。可以使用不同的路由规则或者负载均衡策略来将请求分发到不同的后端服务。</li>
<li>分流策略设置：在 Gateway 中设置分流策略，逐渐将流量从旧版本的后端服务迁移到新版本的后端服务上。可以根据实际需求逐步提高新版本服务的流量占比，例如每天增加一定比例的流量。</li>
<li>监控和调整：监控新版本服务的性能和稳定性，确保新版本服务能够正常运行。如果发现问题，可以及时调整配置或者回滚迁移操作。</li>
<li>逐步迁移：在经过一段时间的监控和调整后，当新版本服务被充分验证并且稳定运行时，可以逐步将流量从旧版本服务全面切换到新版本服务上。</li>
<li>清理旧版本：在所有流量都已经迁移到新版本服务后，可以将旧版本服务从 Gateway 的配置中移除，并进行清理操作。</li>
</ol>
<p>需要注意的是，在服务平滑迁移过程中，要确保新版本服务和旧版本服务的接口和功能兼容，以避免对客户端的影响。此外，还应该做好监控和回滚准备，以应对可能出现的问题。</p>
<h2 id="31、Seata-支持那些事务模式？"><a href="#31、Seata-支持那些事务模式？" class="headerlink" title="31、Seata 支持那些事务模式？"></a>31、Seata 支持那些事务模式？</h2><p>概念：Seata 是一款开源的分布式事务解决方案，致力于提供高性能和简单易用的分布式事务服务。Seata 将为用户提供了 AT、TCC、SAGA 和 XA 事务模式，为用户打造一站式的分布式解决方案。</p>
<ol>
<li>AT（Atomikos）模式：AT 模式是 Seata 的默认事务模式，它通过在业务代码中嵌入事务上下文，实现分布式事务的一致性。在 AT 模式下，Seata 会对参与分布式事务的数据库进行事务协调和管理，保证所有数据库的数据一致性。提供无侵入自动补偿的事务模式 【这里是基于本地能支持事务的关系型数据库，然后 java 代码可以通过 JDBC 访问数据库， 这里的无侵入：我们只需要加上对应的注解就可以开启全局事务】</li>
<li>TCC（Try-Confirm-Cancel）模式：TCC 模式是一种补偿性事务模式，它通过定义业务的 Try、Confirm 和 Cancel 三个阶段来实现分布式事务的一致性。在 TCC 模式下，Seata 会根据业务代码中定义的 Try、Confirm 和 Cancel 方法来执行事务操作，保证事务的一致性。</li>
<li>SAGA（Saga）模式：SAGA 模式是一种长事务模式，它通过定义一系列的事务步骤来实现分布式事务的一致性。在 SAGA 模式下，Seata 会按照业务代码中定义的事务步骤顺序执行，每个步骤都有对应的补偿操作，以保证整个事务的一致性。</li>
<li>XA（X&#x2F;Open XA）模式：XA 模式是一种基于两阶段提交（2 PC）的事务模式，它通过协调参与分布式事务的资源管理器（如数据库）来实现事务的一致性。在 XA 模式下，Seata 会与各个资源管理器进行协调，确保所有资源的提交或回滚操作都能正确执行，以保证分布式事务的一致性。</li>
</ol>
<h2 id="32、请简述-2-PC-流程以及优缺点"><a href="#32、请简述-2-PC-流程以及优缺点" class="headerlink" title="32、请简述 2 PC 流程以及优缺点"></a>32、请简述 2 PC 流程以及优缺点</h2><p>2 PC（Two-Phase Commit）是一种经典的分布式事务协议，它通过两个阶段的协调来实现分布式事务的一致性。以下是 2 PC 的基本流程：</p>
<ol>
<li><p>准备阶段（Prepare Phase）：</p>
<ul>
<li>协调者（Coordinator）向参与者（Participant）发送事务准备请求。</li>
<li>参与者执行事务操作，并将事务日志和准备完成的消息发送给协调者。</li>
<li>协调者收到所有参与者的准备完成消息后，进入下一阶段。如果有任何一个参与者发生错误或者超时，协调者将发送回滚请求给所有参与者。</li>
</ul>
</li>
<li><p>提交阶段（Commit Phase）：</p>
<ul>
<li>协调者向所有参与者发送事务提交请求。</li>
<li>参与者执行事务的最终提交操作，并将提交完成的消息发送给协调者。</li>
<li>协调者收到所有参与者的提交完成消息后，向所有参与者发送事务完成的消息，事务完成。</li>
</ul>
</li>
</ol>
<p>2 PC 的优点：</p>
<ul>
<li>数据一致性：2 PC 可以保证所有参与者的数据在事务提交时保持一致，即要么全部提交成功，要么全部回滚。</li>
<li>简单易用：2 PC 是一个相对简单的分布式事务协议，易于理解和实现。</li>
</ul>
<p>2 PC 的缺点：</p>
<ul>
<li>同步阻塞：在 2 PC 的过程中，所有参与者都需要等待协调者的指令，这会导致整个事务的执行过程存在阻塞，影响性能和吞吐量。</li>
<li>单点故障：2 PC 中的协调者是一个单点，如果协调者发生故障，整个事务的执行将受到影响。</li>
<li>阻塞风暴：如果在准备阶段中的任何一个参与者发生故障或者超时，协调者将发送回滚请求给所有参与者，导致参与者之间的通信产生大量的回滚请求，可能引发阻塞风暴。</li>
</ul>
<p>综上所述，2 PC 是一种经典的分布式事务协议，能够保证数据一致性，但存在同步阻塞和单点故障等问题。因此，在实际应用中，可以根据具体的业务需求和性能要求选择合适的分布式事务协议。</p>
<h2 id="33、Seata中xid怎样通过-Feign-进行全局传递"><a href="#33、Seata中xid怎样通过-Feign-进行全局传递" class="headerlink" title="33、Seata中xid怎样通过 Feign 进行全局传递"></a>33、Seata中xid怎样通过 Feign 进行全局传递</h2><p>在 Seata 中，XID（全局事务 ID）是用来标识一个全局事务的唯一标识符。在使用 Feign 进行服务之间的远程调用时，可以通过以下方式将 XID 传递给下游服务：</p>
<ol>
<li>通过请求头传递：在发起 Feign 请求时，可以将 XID 设置为请求头的一部分，并在下游服务中解析该请求头获取 XID。例如，可以使用 <code>@RequestHeader</code>​ 注解将 XID 传递给下游服务。</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@FeignClient(name = &quot;serviceB&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ServiceBClient</span> &#123;</span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/api/serviceB&quot;, method = RequestMethod.GET)</span></span><br><span class="line">    String <span class="title function_">getServiceB</span><span class="params">(<span class="meta">@RequestHeader(&quot;XID&quot;)</span> String xid)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>通过请求参数传递：将 XID 作为请求参数传递给下游服务。在定义 Feign 接口方法时，将 XID 作为方法的参数，并在请求中传递给下游服务。下游服务通过解析请求参数获取 XID。</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@FeignClient(name = &quot;serviceB&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ServiceBClient</span> &#123;</span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/api/serviceB&quot;, method = RequestMethod.GET)</span></span><br><span class="line">    String <span class="title function_">getServiceB</span><span class="params">(<span class="meta">@RequestParam(&quot;XID&quot;)</span> String xid)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>通过以上方式，在 Feign 远程调用中传递 XID，可以确保全局事务上下文在服务之间的传递和一致性。同时，下游服务需要正确解析和使用 XID，以保证参与到全局事务中。</p>
<h2 id="34、分布式事务应用的典型场景"><a href="#34、分布式事务应用的典型场景" class="headerlink" title="34、分布式事务应用的典型场景"></a>34、分布式事务应用的典型场景</h2><p><strong>1、多服务</strong></p>
<p>随着互联网快速发展，微服务，SOA 等服务架构模式正在被大规模的使用，会出现很多分布式事务，问题如下：</p>
<p><img src="https://testingcf.jsdelivr.net/gh/LunaNorth/img-cloud/images/network-asset-7-9-20240823074506-4yps7df.png">​</p>
<p><strong>2、多数据源</strong></p>
<p><strong>2.1 跨库</strong></p>
<p>跨库事务指的是，一个应用某个功能需要操作多个库，如下图：</p>
<p><img src="https://testingcf.jsdelivr.net/gh/LunaNorth/img-cloud/images/network-asset-7-10-20240823074506-90bx7x0.png">​</p>
<p><strong>2.2 分库分表</strong></p>
<p>通常一个库数据量比较大或者预期未来的数据量比较大，都会进行水平拆分，也就是分库分表。如下图，将订单数据库拆分成了 4 个库：</p>
<p><img src="https://testingcf.jsdelivr.net/gh/LunaNorth/img-cloud/images/network-asset-7-11-20240823074507-2o9hqev.png">​</p>
<h2 id="35、请说一下-CAP-和-BASE-理论"><a href="#35、请说一下-CAP-和-BASE-理论" class="headerlink" title="35、请说一下 CAP 和 BASE 理论"></a>35、请说一下 CAP 和 BASE 理论</h2><p>CAP 和 BASE 是分布式必备理论基础</p>
<p><strong>1、CAP理论</strong></p>
<p>这个定理的内容是指的是在一个分布式系统中、Consistency（一致性）、 Availability（可用性）、Partition tolerance（分区容错性），三者不可得兼。</p>
<ul>
<li>一致性（C）</li>
</ul>
<p>一致性意思就是写操作之后进行读操作无论在哪个节点都需要返回写操作的值</p>
<ul>
<li>可用性（A）</li>
</ul>
<p>非故障的节点在合理的时间内返回合理的响应</p>
<ul>
<li>分区容错性（P）</li>
</ul>
<p>当出现网络分区后，系统能够继续工作。打个比方，这里个集群有多台机器，有台机器网络出现了问题，但是这个集群仍然可以正常工作。在分布式系统中，网络无法 100% 可靠，分区其实是一个必然现象，如果我们选择了 CA 而放弃了 P，那么当发生分区现象时，为了保证一致性，这个时候必须拒绝请求，但是 A 又不允许，所以分布式系统理论上不可能选择CA架构，只能选择 CP 或者 AP 架构。</p>
<p>对于CP来说，放弃可用性，追求一致性和分区容错性，我们的 zookeeper 其实就是追求的强一致。</p>
<p>对于 AP 来说，放弃一致性（这里说的一致性是强一致性），追求分区容错性和可用性，Nacos 就是 AP 模式，这是很多分布式系统设计时的选择，后面的 BASE 也是根据 AP 来扩展。</p>
<p><strong>2、BASE理论</strong></p>
<p>BASE 是 Basically Available（基本可用）、Soft state（软状态）和 Eventually consistent（最终一致性）三个短语的缩写。BASE 理论是对 CAP 中一致性和可用性权衡的结果，其来源于对大规模互联网系统分布式实践的总结， 是基于 CAP 定理逐步演化而来的。BASE 理论的核心思想是：<strong>即使无法做到强一致性，但每个应用都可以根据自身业务特点，采用适当的方式来使系统达到最终一致性。</strong></p>
<ul>
<li>基本可用</li>
</ul>
<p>基本可用是指分布式系统在出现不可预知故障的时候，允许损失部分可用性—-注意，这绝不等价于系统不可用。比如：</p>
<p>（1）<strong>响应时间上的损失</strong>。正常情况下，一个在线搜索引擎需要在0.5秒之内返回给用户相应的查询结果，但由于出现故障，查询结果的响应时间增加了 1~2 秒</p>
<p>（2）<strong>系统功能上的损失</strong>：正常情况下，在一个电子商务网站上进行购物的时候，消费者几乎能够顺利完成每一笔订单，但是在一些节日大促购物高峰的时候，由于消费者的购物行为激增，为了保护购物系统的稳定性，部分消费者可能会被引导到一个降级页面</p>
<ul>
<li>软状态</li>
</ul>
<p>软状态指允许系统中的数据存在中间状态，并认为该中间状态的存在不会影响系统的整体可用性，即允许系统在不同节点的数据副本之间进行数据同步的过程存在延时</p>
<ul>
<li>最终一致性</li>
</ul>
<p>最终一致性强调的是所有的数据副本，在经过一段时间的同步之后，最终都能够达到一个一致的状态。因此，最终一致性的本质是需要系统保证最终数据能够达到一致，而不需要实时保证系统数据的强一致性。</p>
<h2 id="36、简述-Seata-的-AT-模式两阶段过程"><a href="#36、简述-Seata-的-AT-模式两阶段过程" class="headerlink" title="36、简述 Seata 的 AT 模式两阶段过程"></a>36、简述 Seata 的 AT 模式两阶段过程</h2><p>Seata的AT（Atomikos）模式是一种基于应用程序代码的分布式事务处理模式。它通过两阶段提交（Two-Phase Commit，2PC）的方式来实现分布式事务的一致性。</p>
<p>下面是Seata AT模式的两阶段过程：</p>
<ol>
<li><p>阶段一：准备阶段（Prepare Phase）</p>
<ul>
<li>应用程序发起一个分布式事务，并向Seata事务协调器注册该事务。</li>
<li>Seata 事务协调器将该事务注册到全局事务日志中，并生成一个全局事务ID（Global Transaction ID）。</li>
<li>应用程序在本地事务执行前，会先向Seata事务协调器发送分支事务的注册请求。</li>
<li>Seata 事务协调器会将分支事务注册到全局事务中，并生成一个分支事务ID（Branch Transaction ID）。</li>
<li>应用程序执行本地事务，并将事务执行结果（成功或失败）发送给 Seata 事务协调器。</li>
</ul>
</li>
<li><p>阶段二：提交&#x2F;回滚阶段（Commit&#x2F;Rollback Phase）</p>
<ul>
<li>如果所有分支事务的本地事务都执行成功，Seata 事务协调器会发送一个全局提交请求给各个分支事务参与者。</li>
<li>分支事务参与者接收到全局提交请求后，会执行本地事务的提交操作，并将提交结果发送给 Seata 事务协调器。</li>
<li>如果任何一个分支事务的本地事务执行失败，Seata 事务协调器会发送一个全局回滚请求给各个分支事务参与者。</li>
<li>分支事务参与者接收到全局回滚请求后，会执行本地事务的回滚操作，并将回滚结果发送给 Seata 事务协调器。</li>
</ul>
</li>
</ol>
<p>通过这个两阶段的过程，Seata AT 模式可以确保分布式事务的一致性。如果所有分支事务的本地事务执行成功，那么全局提交请求将被发送，所有分支事务都会提交。如果任何一个分支事务的本地事务执行失败，那么全局回滚请求将被发送，所有分支事务都会回滚。</p>
<h2 id="37、简述-Eureka-自我保护机制"><a href="#37、简述-Eureka-自我保护机制" class="headerlink" title="37、简述 Eureka 自我保护机制"></a>37、简述 Eureka 自我保护机制</h2><p>Eureka 服务端会检查最近 15 分钟内所有 Eureka 实例正常心跳占比，如果低于 85% 就会触发自我保护机制。触发了保护机制，Eureka将暂时把这些失效的服务保护起来，不让其过期，但这些服务也并不是永远不会过期。Eureka 在启动完成后，每隔 60 秒会检查一次服务健康状态，如果这些被保护起来失效的服务过一段时间后（默认 90 秒）还是没有恢复，就会把这些服务剔除。如果在此期间服务恢复了并且实例心跳占比高于 85% 时，就会自动关闭自我保护机制。</p>
<p>阈值的计算方式：</p>
<p>每分钟 能接受最少的续租次数 &#x3D; 微服务实例总数 * （60 s &#x2F; 实例的续约时间间隔：30s ） * 有效的心跳比率 默认 85%</p>
<p>100 乘以（60 &#x2F;30） 乘以 85% &#x3D; 170</p>
<p>自我保护机制更改条件： 注册、服务下架、 服务初始化、15 分钟更新一次</p>
<p>自我保护机制的触发位置： 服务剔除</p>
<h2 id="38、简述-Eureka-集群架构"><a href="#38、简述-Eureka-集群架构" class="headerlink" title="38、简述 Eureka 集群架构"></a>38、简述 Eureka 集群架构</h2><p>参考官网：<a target="_blank" rel="noopener" href="https://github.com/Netflix/eureka/wiki/Eureka-at-a-glance">https://github.com/Netflix/eureka/wiki/Eureka-at-a-glance</a></p>
<ul>
<li>Register（服务注册）：把自己的 IP 和端口注册给 Eureka。</li>
<li>Renew（服务续约）：发送心跳包，每 30 秒发送一次。告诉 Eureka 自己还活着。</li>
<li>Cancel（服务下线）：当 provider 关闭时会向 Eureka 发送消息，把自己从服务列表中删除。防止 consumer 调用到不存在的服务。</li>
<li>Get Registry（获取服务注册列表）：获取其他服务列表。</li>
<li>Make Remote Call（远程调用）：完成服务的远程调用。</li>
<li>Replicate（集群中数据同步）：eureka 集群中的数据复制与同步。</li>
</ul>
<h2 id="39、从-Eureka-迁移到-Nacos-的解决方案"><a href="#39、从-Eureka-迁移到-Nacos-的解决方案" class="headerlink" title="39、从 Eureka 迁移到 Nacos 的解决方案"></a>39、从 Eureka 迁移到 Nacos 的解决方案</h2><p>版本依赖关系：</p>
<p><a target="_blank" rel="noopener" href="https://github.com/alibaba/spring-cloud-alibaba/wiki/%E7%89%88%E6%9C%AC%E8%AF%B4%E6%98%8E">https://github.com/alibaba/spring-cloud-alibaba/wiki/%E7%89%88%E6%9C%AC%E8%AF%B4%E6%98%8E</a></p>
<p><img src="https://testingcf.jsdelivr.net/gh/LunaNorth/img-cloud/images/network-asset-7-12-20240823074507-0rf699x.png">​</p>
<ul>
<li><p>换依赖</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"> &lt;spring-cloud.alibaba.version&gt;2.2.9.RELEASE&lt;/spring-cloud.alibaba.version&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line"> &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;</span><br><span class="line"> &lt;artifactId&gt;spring-cloud-alibaba-dependencies&lt;/artifactId&gt;</span><br><span class="line"> &lt;version&gt;$&#123;spring-cloud.alibaba.version&#125;&lt;/version&gt;</span><br><span class="line"> &lt;type&gt;pom&lt;/type&gt;</span><br><span class="line"> &lt;scope&gt;import&lt;/scope&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">&lt;dependencies&gt;</span><br><span class="line"> &lt;dependency&gt;</span><br><span class="line"> &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;</span><br><span class="line"> &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;/artifactId&gt;</span><br><span class="line"> &lt;/dependency&gt;</span><br><span class="line">&lt;/dependencies&gt;</span><br></pre></td></tr></table></figure></li>
<li><p>配置换一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">spring:</span><br><span class="line"> cloud:</span><br><span class="line"> nacos:</span><br><span class="line"> discovery:</span><br><span class="line"> server-addr: localhost:8848</span><br><span class="line"> service: msb-order</span><br></pre></td></tr></table></figure></li>
<li><p>使用 <code>@EnableDiscoveryClient</code>​ 开启注册发现</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@EnableDiscoveryClient // 这是官方提供的 ,我们以后可能切换其他的注册中心比如说 nacos，那我们就直接切换就行了</span><br><span class="line"></span><br><span class="line">//@EnableEurekaClient // 是 netflix 提供的，如果用这个注解就只能服务于 eureka</span><br></pre></td></tr></table></figure></li>
<li><p>梳理项目关系</p>
<p>只提供调用的基础服务先进行更改，进行迁移</p>
</li>
</ul>
<h2 id="40、Apollo的整体架构"><a href="#40、Apollo的整体架构" class="headerlink" title="40、Apollo的整体架构"></a>40、Apollo的整体架构</h2><p><img src="https://testingcf.jsdelivr.net/gh/LunaNorth/img-cloud/images/network-asset-7-13-20240823074508-6jo3206.png">​</p>
<ul>
<li>Config Service 提供配置的读取、推送等功能，服务对象是 Apollo 客户端。</li>
<li>Admin Service 提供配置的修改、发布等功能，服务对象是 Apollo Portal（管理界面）。</li>
<li>Config Service 和 Admin Service 都是多实例、无状态部署，所以需要将自己注册到 Eureka 中并保持心跳。</li>
<li>在 Eureka 之上我们架了一层 Meta Serve r用于封装 Eureka 的服务发现接口。</li>
<li>Client 通过域名访问 Meta Server 获取 Config Service 服务列表（IP+Port），而后直接通过 IP+Port 访问服务，同时在 Client 侧会做 load balance、错误重试。</li>
<li>Portal 通过域名访问 Meta Server 获取 Admin Service 服务列表（IP+Port），而后直接通过 IP+Port 访问服务，同时在 Portal 侧会做 load balance、错误重试。</li>
</ul>
<p>为了简化部署，我们实际上会把 Config Service、Eureka 和 Meta Server 三个逻辑角色部署在同一个 JVM 进程中。</p>
<h2 id="41、Apollo的整体架构可靠性分析"><a href="#41、Apollo的整体架构可靠性分析" class="headerlink" title="41、Apollo的整体架构可靠性分析"></a>41、Apollo的整体架构可靠性分析</h2><table>
<thead>
<tr>
<th>场景</th>
<th>影响</th>
<th>降级</th>
</tr>
</thead>
<tbody><tr>
<td>某台 Config Service 下线</td>
<td>无影响</td>
<td></td>
</tr>
<tr>
<td>所有 Config Service 下线</td>
<td>客户端无法读取最新配置，Portal 无影响</td>
<td>客户端重启时，可以读取本地缓存配置文件。如果是新扩容的机器，可以从其它机器上获取已缓存的配置文件，具体信息可以参考 Java 客户端使用指南 - 1.2.3 本地缓存路径</td>
</tr>
<tr>
<td>某台 Admin Service下线</td>
<td>无影响</td>
<td></td>
</tr>
<tr>
<td>所有 Admin Service下线</td>
<td>客户端无影响，Portal无法更新配置</td>
<td></td>
</tr>
<tr>
<td>某台 Portal 下线</td>
<td>无影响</td>
<td></td>
</tr>
<tr>
<td>全部 Portal 下线</td>
<td>客户端无影响，Portal无法更新配置</td>
<td></td>
</tr>
<tr>
<td>某个数据中心下线</td>
<td>无影响</td>
<td></td>
</tr>
<tr>
<td>数据库宕机</td>
<td>客户端无影响，Portal无法更新配置</td>
<td>Config Service 开启配置缓存后，对配置的读取不受数据库宕机影响</td>
</tr>
</tbody></table>
<h2 id="42、Apollo配置发布后的实时推送设计"><a href="#42、Apollo配置发布后的实时推送设计" class="headerlink" title="42、Apollo配置发布后的实时推送设计"></a>42、Apollo配置发布后的实时推送设计</h2><p>在配置中心中，一个重要的功能就是配置发布后实时推送到客户端。下面我们简要看一下这块是怎么设计实现的。</p>
<p><img src="https://testingcf.jsdelivr.net/gh/LunaNorth/img-cloud/images/network-asset-7-14-20240823074508-t5973v5.png">​</p>
<p>上图简要描述了配置发布的大致过程：</p>
<ol>
<li><p>用户在 Portal 操作配置发布</p>
</li>
<li><p>Portal 调用 Admin Service 的接口操作发布</p>
</li>
<li><p>Admin Service 发布配置后，发送 <code>ReleaseMessage</code>​ 给各个Config Service</p>
</li>
<li><p>Config Service收到 <code>ReleaseMessage</code>​ 后，通知对应的客户端</p>
<p> <img src="https://testingcf.jsdelivr.net/gh/LunaNorth/img-cloud/images/network-asset-7-15-20240823074509-m235mgv.png">​</p>
</li>
</ol>
<h2 id="43、Apollo-客户端设计"><a href="#43、Apollo-客户端设计" class="headerlink" title="43、Apollo 客户端设计"></a>43、Apollo 客户端设计</h2><p><img src="https://testingcf.jsdelivr.net/gh/LunaNorth/img-cloud/images/network-asset-7-16-20240823074509-om6093t.png">​</p>
<p>上图简要描述了 Apollo 客户端的实现原理：</p>
<ol>
<li>客户端和服务端保持了一个长连接，从而能第一时间获得配置更新的推送。（通过Http Long Polling实现）</li>
<li>客户端还会定时从Apollo配置中心服务端拉取应用的最新配置。</li>
<li>客户端从Apollo配置中心服务端获取到应用的最新配置后，会保存在内存中</li>
<li>客户端会把从服务端获取到的配置在本地文件系统缓存一份，在遇到服务不可用，或网络不通的时候，依然能从本地恢复配置</li>
<li>应用程序可以从 Apollo 客户端获取最新的配置、订阅配置更新通知</li>
</ol>
<h2 id="44、Zuul-有几种过滤器类型？分别是？"><a href="#44、Zuul-有几种过滤器类型？分别是？" class="headerlink" title="44、Zuul 有几种过滤器类型？分别是？"></a>44、Zuul 有几种过滤器类型？分别是？</h2><p>Zuul 有四种过滤器类型，分别是：</p>
<ol>
<li><p>前置过滤器（Pre Filter）：在请求被路由之前执行。可以用来做身份验证、请求参数校验、记录调试信息等操作。</p>
</li>
<li><p>路由过滤器（Route Filter）：用于将请求转发到目标服务实例。可以修改请求的路由规则、请求头等信息。</p>
</li>
<li><p>这种过滤器用于构建发送给微服务的请求，并使用 Apache HttpClient 或 Netfilx feign 请求</p>
</li>
<li><p>后置过滤器（Post Filter）：在目标服务实例处理完请求并返回响应之后执行。可用来为响应添加标准的HTTP Header、收</p>
<p> 集统计信息和指标、将响应从微服务发送给客户端，可以对响应进行处理，如添加响应头、修改响应内容等。</p>
</li>
<li><p>错误过滤器（Error Filter）：在整个请求生命周期中发生错误时执行。可以对错误进行处理，如记录错误日志、返回自定义错误信息等。</p>
</li>
</ol>
<p>通过使用这四种过滤器类型，可以在Zuul网关中实现各种功能，如安全认证、请求转发、日志记录等。开发人员可以自定义各种过滤器，并将它们按照需要配置到Zuul网关中，以实现特定的功能和需求。</p>
</article><div class="post-copyright"><div class="post-copyright__title"><span class="post-copyright-info"><h>SpringCloud 篇</h></span></div><div class="post-copyright__type"><span class="post-copyright-info"><a href="https://lunanorth.github.io/posts/28286.html">https://lunanorth.github.io/posts/28286.html</a></span></div><div class="post-copyright-m"><div class="post-copyright-m-info"><div class="post-copyright-a"><h>作者</h><div class="post-copyright-cc-info"><h>捞月亮の小北</h></div></div><div class="post-copyright-c"><h>发布于</h><div class="post-copyright-cc-info"><h>2024-08-29</h></div></div><div class="post-copyright-u"><h>更新于</h><div class="post-copyright-cc-info"><h>2024-08-29</h></div></div><div class="post-copyright-c"><h>许可协议</h><div class="post-copyright-cc-info"><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a rel="noopener" target="_blank" title="CC BY-NC-SA 4.0" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></div></div></div></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/SpringCloud/">SpringCloud</a></div><div class="post_share"><div class="social-share" data-image="https://testingcf.jsdelivr.net/gh/LunaNorth/img-cloud/images/wallhaven-7p7wev.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/43711.html" title="1. 初识算法"><img class="cover" src="https://s21.ax1x.com/2024/08/30/pAAIXrT.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">1. 初识算法</div></div></a></div><div class="next-post pull-right"><a href="/posts/37820.html" title="博客日志"><img class="cover" src="https://testingcf.jsdelivr.net/gh/LunaNorth/img-cloud/images/sy14.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">博客日志</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/posts/11212.html" title="1. 初始微服务"><img class="cover" src="https://s21.ax1x.com/2024/09/08/pAeD4eA.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-09-08</div><div class="title">1. 初始微服务</div></div></a></div><div><a href="/posts/1457.html" title="微服务拆分作业"><img class="cover" src="https://s21.ax1x.com/2024/09/08/pAeWro4.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-09-08</div><div class="title">微服务拆分作业</div></div></a></div></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">捞月亮の小北</div><div class="author-info__description">言念君子 ，温其如玉</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">60</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">26</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">7</div></a></div><a id="card-info-btn" href="https://lunanorth.github.io/"><i class="fab fa-github"></i><span>剑气长安</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">请不要把陌生人的些许善意，视为珍稀的瑰宝，却把身边亲近人的全部付出，当做天经地义的事情，对其视而不见!</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E3%80%81%E4%BB%80%E4%B9%88%E6%98%AF"><span class="toc-text">1、什么是</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E3%80%81%E4%BB%80%E4%B9%88%E6%98%AF%E5%BE%AE%E6%9C%8D%E5%8A%A1"><span class="toc-text">2、什么是微服务</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3%E3%80%81SpringCloud-%E6%9C%89%E4%BB%80%E4%B9%88%E4%BC%98%E5%8A%BF"><span class="toc-text">3、SpringCloud 有什么优势</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4%E3%80%81-%E4%BB%80%E4%B9%88%E6%98%AF%E6%9C%8D%E5%8A%A1%E7%86%94%E6%96%AD%EF%BC%9F%E4%BB%80%E4%B9%88%E6%98%AF%E6%9C%8D%E5%8A%A1%E9%99%8D%E7%BA%A7%EF%BC%9F"><span class="toc-text">4、 什么是服务熔断？什么是服务降级？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5%E3%80%81Eureka-%E5%92%8C-zookeeper-%E9%83%BD%E5%8F%AF%E4%BB%A5%E6%8F%90%E4%BE%9B%E6%9C%8D%E5%8A%A1%E6%B3%A8%E5%86%8C%E4%B8%8E%E5%8F%91%E7%8E%B0%E7%9A%84%E5%8A%9F%E8%83%BD%EF%BC%8C%E8%AF%B7%E8%AF%B4%E8%AF%B4%E4%B8%A4%E4%B8%AA%E7%9A%84%E5%8C%BA%E5%88%AB%EF%BC%9F"><span class="toc-text">5、Eureka 和 zookeeper 都可以提供服务注册与发现的功能，请说说两个的区别？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6%E3%80%81SpringBoot-%E5%92%8C-SpringCloud-%E7%9A%84%E5%8C%BA%E5%88%AB%EF%BC%9F"><span class="toc-text">6、SpringBoot 和 SpringCloud 的区别？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7%E3%80%81%E8%B4%9F%E8%BD%BD%E5%B9%B3%E8%A1%A1%E7%9A%84%E6%84%8F%E4%B9%89%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-text">7、负载平衡的意义什么？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8%E3%80%81%E4%BB%80%E4%B9%88%E6%98%AF-Hystrix-%EF%BC%9F%E5%AE%83%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E5%AE%B9%E9%94%99%EF%BC%9F"><span class="toc-text">8、什么是 Hystrix ？它如何实现容错？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9%E3%80%81%E4%BB%80%E4%B9%88%E6%98%AF-Hystrix-%E6%96%AD%E8%B7%AF%E5%99%A8%EF%BC%9F%E6%88%91%E4%BB%AC%E9%9C%80%E8%A6%81%E5%AE%83%E5%90%97%EF%BC%9F"><span class="toc-text">9、什么是 Hystrix 断路器？我们需要它吗？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10%E3%80%81%E8%AF%B4%E8%AF%B4-RPC-%E7%9A%84%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86"><span class="toc-text">10、说说 RPC 的实现原理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11%E3%80%81Eureka-%E8%87%AA%E6%88%91%E4%BF%9D%E6%8A%A4%E6%9C%BA%E5%88%B6%E6%98%AF%E4%BB%80%E4%B9%88"><span class="toc-text">11、Eureka 自我保护机制是什么?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12%E3%80%81%E4%BB%80%E4%B9%88%E6%98%AF-Ribbon-%EF%BC%9F"><span class="toc-text">12、什么是 Ribbon ？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13%E3%80%81%E4%BB%80%E4%B9%88%E6%98%AF-feigin-%EF%BC%9F%E5%AE%83%E7%9A%84%E4%BC%98%E7%82%B9%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-text">13、什么是 feigin ？它的优点是什么？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14%E3%80%81Ribbon-%E5%92%8C-Feign-%E7%9A%84%E5%8C%BA%E5%88%AB%EF%BC%9F"><span class="toc-text">14、Ribbon 和 Feign 的区别？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#15%E3%80%81%E5%A6%82%E4%BD%95%E8%AE%BE%E8%AE%A1%E4%B8%80%E4%B8%AA%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83%EF%BC%9F"><span class="toc-text">15、如何设计一个注册中心？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#16%E3%80%81Nacos1-x-%E4%BD%9C%E4%B8%BA%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83%E7%9A%84%E5%8E%9F%E7%90%86%EF%BC%9F"><span class="toc-text">16、Nacos1.x 作为注册中心的原理？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#17%E3%80%81Nacos-%E6%9C%8D%E5%8A%A1%E9%A2%86%E5%9F%9F%E6%A8%A1%E5%9E%8B%E6%9C%89%E5%93%AA%E4%BA%9B%EF%BC%9F"><span class="toc-text">17、Nacos 服务领域模型有哪些？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#18%E3%80%81Nacos%E4%B8%AD%E7%9A%84Distro%E5%8D%8F%E8%AE%AE"><span class="toc-text">18、Nacos中的Distro协议</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#19%E3%80%81%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83%E7%9A%84%E6%8A%80%E6%9C%AF%E9%80%89%E5%9E%8B"><span class="toc-text">19、配置中心的技术选型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#20%E3%80%81Nacos1-x-%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83%E9%95%BF%E8%BD%AE%E8%AF%A2%E6%9C%BA%E5%88%B6%EF%BC%9F"><span class="toc-text">20、Nacos1.x 配置中心长轮询机制？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#21%E3%80%81Nacos-%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83%E9%85%8D%E7%BD%AE%E4%BC%98%E5%85%88%E7%BA%A7%EF%BC%9F"><span class="toc-text">21、Nacos 配置中心配置优先级？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#22%E3%80%81Nacos-2-x-%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%8E%A2%E6%B4%BB%E6%9C%BA%E5%88%B6%EF%BC%9F"><span class="toc-text">22、Nacos 2.x 客户端探活机制？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#23%E3%80%81Ribbon-%E5%BA%95%E5%B1%82%E6%80%8E%E6%A0%B7%E5%AE%9E%E7%8E%B0%E4%B8%8D%E5%90%8C%E6%9C%8D%E5%8A%A1%E7%9A%84%E4%B8%8D%E5%90%8C%E9%85%8D%E7%BD%AE"><span class="toc-text">23、Ribbon 底层怎样实现不同服务的不同配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#24%E3%80%81%E4%B8%BA%E4%BB%80%E4%B9%88-Feign-%E7%AC%AC%E4%B8%80%E6%AC%A1%E8%B0%83%E7%94%A8%E8%80%97%E6%97%B6%E5%BE%88%E9%95%BF%EF%BC%9F"><span class="toc-text">24、为什么 Feign 第一次调用耗时很长？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#25%E3%80%81Ribbon-%E7%9A%84%E5%B1%9E%E6%80%A7%E9%85%8D%E7%BD%AE%E5%92%8C%E7%B1%BB%E9%85%8D%E7%BD%AE%E4%BC%98%E5%85%88%E7%BA%A7"><span class="toc-text">25、Ribbon 的属性配置和类配置优先级</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#26%E3%80%81Feign-%E7%9A%84%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%EF%BC%9F"><span class="toc-text">26、Feign 的性能优化？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#27%E3%80%81Feign-%E6%80%8E%E6%A0%B7%E5%AE%9E%E7%8E%B0%E8%AE%A4%E8%AF%81%E7%9A%84%E4%BC%A0%E9%80%92%EF%BC%9F"><span class="toc-text">27、Feign 怎样实现认证的传递？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#28%E3%80%81%E8%B0%88%E8%B0%88-Sentienl-%E4%B8%AD%E4%BD%BF%E7%94%A8%E7%9A%84%E9%99%90%E6%B5%81%E7%AE%97%E6%B3%95"><span class="toc-text">28、谈谈 Sentienl 中使用的限流算法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#29%E3%80%81%E8%B0%88%E8%B0%88-Sentienl-%E6%9C%8D%E5%8A%A1%E7%86%94%E6%96%AD%E8%BF%87%E7%A8%8B"><span class="toc-text">29、谈谈 Sentienl 服务熔断过程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#30%E3%80%81%E5%9C%A8-Gateway-%E4%B8%AD%E6%80%8E%E6%A0%B7%E5%AE%9E%E7%8E%B0%E6%9C%8D%E5%8A%A1%E5%B9%B3%E6%BB%91%E8%BF%81%E7%A7%BB%EF%BC%9F"><span class="toc-text">30、在 Gateway 中怎样实现服务平滑迁移？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#31%E3%80%81Seata-%E6%94%AF%E6%8C%81%E9%82%A3%E4%BA%9B%E4%BA%8B%E5%8A%A1%E6%A8%A1%E5%BC%8F%EF%BC%9F"><span class="toc-text">31、Seata 支持那些事务模式？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#32%E3%80%81%E8%AF%B7%E7%AE%80%E8%BF%B0-2-PC-%E6%B5%81%E7%A8%8B%E4%BB%A5%E5%8F%8A%E4%BC%98%E7%BC%BA%E7%82%B9"><span class="toc-text">32、请简述 2 PC 流程以及优缺点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#33%E3%80%81Seata%E4%B8%ADxid%E6%80%8E%E6%A0%B7%E9%80%9A%E8%BF%87-Feign-%E8%BF%9B%E8%A1%8C%E5%85%A8%E5%B1%80%E4%BC%A0%E9%80%92"><span class="toc-text">33、Seata中xid怎样通过 Feign 进行全局传递</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#34%E3%80%81%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1%E5%BA%94%E7%94%A8%E7%9A%84%E5%85%B8%E5%9E%8B%E5%9C%BA%E6%99%AF"><span class="toc-text">34、分布式事务应用的典型场景</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#35%E3%80%81%E8%AF%B7%E8%AF%B4%E4%B8%80%E4%B8%8B-CAP-%E5%92%8C-BASE-%E7%90%86%E8%AE%BA"><span class="toc-text">35、请说一下 CAP 和 BASE 理论</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#36%E3%80%81%E7%AE%80%E8%BF%B0-Seata-%E7%9A%84-AT-%E6%A8%A1%E5%BC%8F%E4%B8%A4%E9%98%B6%E6%AE%B5%E8%BF%87%E7%A8%8B"><span class="toc-text">36、简述 Seata 的 AT 模式两阶段过程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#37%E3%80%81%E7%AE%80%E8%BF%B0-Eureka-%E8%87%AA%E6%88%91%E4%BF%9D%E6%8A%A4%E6%9C%BA%E5%88%B6"><span class="toc-text">37、简述 Eureka 自我保护机制</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#38%E3%80%81%E7%AE%80%E8%BF%B0-Eureka-%E9%9B%86%E7%BE%A4%E6%9E%B6%E6%9E%84"><span class="toc-text">38、简述 Eureka 集群架构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#39%E3%80%81%E4%BB%8E-Eureka-%E8%BF%81%E7%A7%BB%E5%88%B0-Nacos-%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"><span class="toc-text">39、从 Eureka 迁移到 Nacos 的解决方案</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#40%E3%80%81Apollo%E7%9A%84%E6%95%B4%E4%BD%93%E6%9E%B6%E6%9E%84"><span class="toc-text">40、Apollo的整体架构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#41%E3%80%81Apollo%E7%9A%84%E6%95%B4%E4%BD%93%E6%9E%B6%E6%9E%84%E5%8F%AF%E9%9D%A0%E6%80%A7%E5%88%86%E6%9E%90"><span class="toc-text">41、Apollo的整体架构可靠性分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#42%E3%80%81Apollo%E9%85%8D%E7%BD%AE%E5%8F%91%E5%B8%83%E5%90%8E%E7%9A%84%E5%AE%9E%E6%97%B6%E6%8E%A8%E9%80%81%E8%AE%BE%E8%AE%A1"><span class="toc-text">42、Apollo配置发布后的实时推送设计</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#43%E3%80%81Apollo-%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%AE%BE%E8%AE%A1"><span class="toc-text">43、Apollo 客户端设计</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#44%E3%80%81Zuul-%E6%9C%89%E5%87%A0%E7%A7%8D%E8%BF%87%E6%BB%A4%E5%99%A8%E7%B1%BB%E5%9E%8B%EF%BC%9F%E5%88%86%E5%88%AB%E6%98%AF%EF%BC%9F"><span class="toc-text">44、Zuul 有几种过滤器类型？分别是？</span></a></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2024 By 捞月亮の小北</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">言念君子 ，温其如玉<p><a target="_blank" href="https://hexo.io/"><img src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&logo=hexo" title="博客框架为Hexo"></a>&nbsp;<a target="_blank" href="https://butterfly.js.org/"><img src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&logo=bitdefender" title="主题采用butterfly"></a>&nbsp;<a target="_blank" href="https://www.jsdelivr.com/"><img src="https://img.shields.io/badge/CDN-jsDelivr-orange?style=flat&logo=jsDelivr" title="本站使用JsDelivr为静态资源提供CDN加速"></a> &nbsp;<a target="_blank" href="https://vercel.com/ "><img src="https://img.shields.io/badge/Hosted-Vervel-brightgreen?style=flat&logo=Vercel" title="本站采用双线部署，默认线路托管于Vercel"></a>&nbsp;<a target="_blank" href="https://vercel.com/ "><img src="https://img.shields.io/badge/Hosted-Coding-0cedbe?style=flat&logo=Codio" title="本站采用双线部署，联通线路托管于Coding"></a>&nbsp;<a target="_blank" href="https://github.com/"><img src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&logo=GitHub" title="本站项目由Gtihub托管"></a>&nbsp;<a target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&logo=Claris" title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"></a></p></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i><span id="percent">0<span>%</span></span></button><button id="go-down" type="button" title="直达底部" onclick="btf.scrollToDest(document.body.scrollHeight, 500)"><i class="fas fa-arrow-down"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="/js/tw_cn.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>(() => {
  const initGitalk = () => {
    const gitalk = new Gitalk(Object.assign({
      clientID: 'Ov23livb5sxAzXC5FAOj',
      clientSecret: '901c2a65d4b136d295133e9a8176b8650d782c41',
      repo: 'blog-gitalk',
      owner: 'LunaNorth',
      admin: ['LunaNorth'],
      id: 'bc3f9050a051c84cf597e498b4808823',
      updateCountCallback: commentCount
    },null))

    gitalk.render('gitalk-container')
  }

  const loadGitalk = async() => {
    if (typeof Gitalk === 'function') initGitalk()
    else {
      await getCSS('https://cdn.jsdelivr.net/npm/gitalk@1.8.0/dist/gitalk.min.css')
      await getScript('https://cdn.jsdelivr.net/npm/gitalk@1.8.0/dist/gitalk.min.js')
      initGitalk()
    }
  }
  
  const commentCount = n => {
    const isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
    if (isCommentCount) {
      isCommentCount.textContent= n
    }
  }

  if ('Gitalk' === 'Gitalk' || !false) {
    if (false) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
    else loadGitalk()
  } else {
    window.loadOtherComment = loadGitalk
  }
})()</script></div><canvas id="universe"></canvas><script async data-pjax src="/js/universe.js"></script><script defer data-pjax src="/js/readPercent.js"></script><script async src="//at.alicdn.com/t/font_2264842_3izu8i5eoc2.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener
  btf.removeGlobalFnEvent('pjax')
  btf.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.13.0"></script></div></div><!-- hexo injector body_end start --><script data-pjax>
  function butterfly_clock_anzhiyu_injector_config(){
    var parent_div_git = document.getElementsByClassName('sticky_layout')[0];
    var item_html = '<div class="card-widget card-clock"><div class="card-glass"><div class="card-background"><div class="card-content"><div id="hexo_electric_clock"><img class="entered loading" id="card-clock-loading" src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/loading.gif" style="height: 120px; width: 100%;" data-ll-status="loading"/></div></div></div></div></div>';
    console.log('已挂载butterfly_clock_anzhiyu')
    if(parent_div_git) {
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var qweather_key = '81efe4afadcd49fc93bcfb1aa5d42b3c';
  var gaud_map_key = 'ea946ee5b69e4a4fe76909e6537b883d';
  var baidu_ak_key = 'undefined';
  var flag = 0;
  var clock_rectangle = '112.982279,28.19409';
  var clock_default_rectangle_enable = 'false';

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_clock_anzhiyu_injector_config();
  }
  else if (epage === cpage){
    butterfly_clock_anzhiyu_injector_config();
  }
  </script><script src="https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0"></script><script data-pjax src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.js"></script><script data-pjax>
  function butterfly_swiper_injector_config(){
    var parent_div_git = document.getElementById('recent-posts');
    var item_html = '<div class="recent-post-item" style="height: auto;width: 100%"><div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container"><div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms;"><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/8ebfad52.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://i0.hdslb.com/bfs/article/f0df51859848acd33731899b1ebe95de645325325.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-08-01</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/8ebfad52.html&quot;);" href="javascript:void(0);" alt="">轻语时光</a><div class="blog-slider__text">我大抵是真的眼花了，竟把一个人的落日，看成了两个人的黄昏</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/8ebfad52.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/facab7a2.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://s21.ax1x.com/2024/08/11/pASTNY8.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-07-20</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/facab7a2.html&quot;);" href="javascript:void(0);" alt="">我在人间凑数的日子</a><div class="blog-slider__text">什么家国仇恨浩然正气的，都不要急。先挑起清风明月，杨柳依依和草长莺飞</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/facab7a2.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/5413be0e.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://testingcf.jsdelivr.net/gh/LunaNorth/img-cloud/images/sy06.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-08-11</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/5413be0e.html&quot;);" href="javascript:void(0);" alt="">健身日记</a><div class="blog-slider__text">请不要把陌生人的些许善意，视为珍稀的瑰宝，却把身边亲近人的全部付出，当做天经地义的事情，对其视而不见。</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/5413be0e.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/37820.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://testingcf.jsdelivr.net/gh/LunaNorth/img-cloud/images/sy14.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-08-24</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/37820.html&quot;);" href="javascript:void(0);" alt="">博客日志</a><div class="blog-slider__text">对该博客进行一个简单的记录</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/37820.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/17639.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://testingcf.jsdelivr.net/gh/LunaNorth/img-cloud/images/18.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-08-16</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/17639.html&quot;);" href="javascript:void(0);" alt="">Tag Plugins Plus 的日常使用</a><div class="blog-slider__text">再怎么看我也不知道怎么描述它的啦！</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/17639.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div></div></div>';
    console.log('已挂载butterfly_swiper')
    parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  var elist = 'undefined'.split(',');
  var cpage = location.pathname;
  var epage = '/';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_swiper_injector_config();
  }
  else if (epage === cpage){
    butterfly_swiper_injector_config();
  }
  </script><script defer src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.js"></script><script defer data-pjax src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper_init.js"></script><script async src="//at.alicdn.com/t/font_2032782_8d5kxvn09md.js"></script><!-- hexo injector body_end end --></body></html>